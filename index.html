<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title> Million Message Wall. One million messages. One wall. One world.  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    #banner {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background-color: #f0c14b;
      color: #000;
      text-align: center;
      padding: 4px 0;
      z-index: 1000;
      font-size: 16px;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    #banner a {
      color: #000;
      text-decoration: none;
      font-weight: bold;
      margin-right: 20px;
    }

    #banner a:hover {
      text-decoration: underline;
    }

    .tile-number {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 20px;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      text-align: center;
      line-height: 20px;
      font-size: 12px;
      opacity: 1;
      transition: opacity 0.3s ease;
    }

    .tile:hover .tile-number {
      opacity: 1;
    }

    .tile-number.hidden {
      display: none;
    }

    html, body {
      margin: 0;
      height: 100%;
      background: #000;
      font-family: sans-serif;
      color: white;
    }

    #viewport {
      width: 100vw;
      height: 1000vh;
      overflow: auto;
      position: relative;
      top: 40px;
    }

    #grid {
      position: relative;
      width: 1600000px;
      height: 900000px;
    }

    .tile {
      position: absolute;
      width: 160px;
      height: 90px;
      background: #222;
      overflow: hidden;
      cursor: pointer;
    }

    .tile img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: center;
    }

    .iframe-container {
      width: 100%;
      height: 100%;
    }

    .iframe-container iframe {
      width: 100%;
      height: 100%;
      border: none;
    }
  </style>
</head>

<body>
  <div id="banner">
    <a href="https://www.indiegogo.com/projects/ssrt-world-s-first-smart-solar-roof-tile" target="_blank">
       Add your message to the Million Message Wall
    </a>
  </div>

  <div id="viewport">
    <div id="grid"></div>
  </div>

  <script>
    const viewport = document.getElementById('viewport');
    const grid = document.getElementById('grid');
    const banner = document.getElementById('banner');
    banner.innerHTML += ` &nbsp; ${10} / 1,000,000 Videos `; // initialVideos.length is 10

    const TILE_WIDTH = 160;
    const TILE_HEIGHT = 90;
    const GRID_COLS = 10;
    const GRID_ROWS = 100000;

    const initialVideos = [
      "dqKpx51vKLc", "WJ-kuy2Bogw", "jfreFPe99GU", "8wtLZzLhIAs",
      "tFU2nhcu2Fs", "EUadj4yDug8", "Xs4Z_4nQV2Y", "C6qOQ9D7puw",
      "P_iiOMd3fOY", "b63IPrrdPOU"
    ];

    const messages = [
      "Blessed are those who expect nothing, for they shall never be disappointed.",
      "Baian√° nananananana",
      "Gotta love that synth",
      "Platinum Doug never disappoints!!",
      "Lets get some quick comfort?!",
      "This is one of the first songs to really get me on the edm train and it doesn't get old",
      "Been listening to Oliver since 2014, never dissapointed, love this man and his music.",
      "This song is ridiculous. I can't go a day without listening to it like 10 times.",
      "To people trying to sing along! Cicovite konje na pajvant pasat Tuti man, tuti man, tuti libe na fidan",
      "I have been looking for this song for five years and all I could remember was. I have the keys to heaven finally found it"
    ];

    const targetLength = 1000000;
    const toAppendCount = targetLength - initialVideos.length;
    const appendedVideos = new Array(toAppendCount).fill("");
    const sampleVideos = initialVideos.concat(appendedVideos);

    let tileNumbersVisible = true;
    const visibleTiles = {};

    function renderTiles() {
      const scrollLeft = viewport.scrollLeft;
      const scrollTop = viewport.scrollTop;
      const viewportWidth = viewport.clientWidth;
      const viewportHeight = viewport.clientHeight;

      const startCol = Math.floor(scrollLeft / TILE_WIDTH);
      const endCol = Math.min(GRID_COLS, Math.ceil((scrollLeft + viewportWidth) / TILE_WIDTH));
      const startRow = Math.floor(scrollTop / TILE_HEIGHT);
      const endRow = Math.min(GRID_ROWS, Math.ceil((scrollTop + viewportHeight) / TILE_HEIGHT));

      const newVisible = {};

      for (let row = startRow; row < endRow; row++) {
        for (let col = startCol; col < endCol; col++) {
          const key = `${row}_${col}`;
          newVisible[key] = true;

          if (!visibleTiles[key]) {
            const index = (row * GRID_COLS + col);
            const youtubeId = sampleVideos[index % sampleVideos.length];

            const tile = document.createElement("div");
            tile.className = "tile";
            tile.style.top = `${row * TILE_HEIGHT}px`;
            tile.style.left = `${col * TILE_WIDTH}px`;

            const img = document.createElement("img");
            img.src = `http://img.youtube.com/vi/${youtubeId}/hqdefault.jpg`;
            img.alt = `Tile ${row}, ${col}`;
            tile.appendChild(img);

            const tileNumber = document.createElement("div");
            tileNumber.className = "tile-number";
            tileNumber.textContent = index + 1;
            if (!tileNumbersVisible) {
              tileNumber.classList.add('hidden');
            }
            tile.appendChild(tileNumber);

            tile.addEventListener("click", () => {
              tile.innerHTML = `
                <div class="iframe-container">
                  <iframe
                    src="https://www.youtube.com/embed/${youtubeId}?autoplay=1&mute=1&playsinline=1"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                    allowfullscreen
                  ></iframe>
                </div>`;

              const message = messages[index % messages.length];
              const videoUrl = `https://www.youtube.com/watch?v=${youtubeId}`;
              banner.innerHTML = `
                Message #${index + 1}: &nbsp;|&nbsp; ${message} 
                &nbsp; &nbsp;
                <a href="${videoUrl}" target="_blank">Click Here to Watch on YouTube</a>
              `;
            });

            grid.appendChild(tile);
            visibleTiles[key] = tile;
          }
        }
      }

      for (let key in visibleTiles) {
        if (!newVisible[key]) {
          grid.removeChild(visibleTiles[key]);
          delete visibleTiles[key];
        }
      }
    }

    renderTiles();

    viewport.addEventListener("scroll", renderTiles);
    viewport.addEventListener("touchmove", renderTiles);
    viewport.addEventListener("wheel", renderTiles);
    window.addEventListener("resize", renderTiles);

  </script>
</body>
</html>
